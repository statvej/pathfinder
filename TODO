Optimise for variable route_count 